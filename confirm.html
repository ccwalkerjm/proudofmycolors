<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="description" content="range of shopping including tee shirts and other items">
    <meta name="author" content="courserv">


    <title>ProudOfMyColors</title>
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/responsive.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
      <script src="js/respond.min.js"></script>
    <![endif]-->
    <!--Favicon  -->
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <!--Favicon  -->
</head>

<body>

    <!-- begin:navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#clotheshop-navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>

            <div class="collapse navbar-collapse" id="clotheshop-navbar">
                <ul class="nav navbar-nav navbar-right" id="menu_items">
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
    </nav>
    <!-- end:navbar -->

    <!-- begin:content -->
    <div class="container">
        <!-- begin:logo -->
        <div class="row">
            <div class="col-md-6 col-sm-6 col-xs-6">
                <div class="logo">
                    <img src="/img/logos/Proud-O-My-Colours_TEXTONLY-02-02_small.png" class="img-responsive" alt="Proud Of My Colors">
                </div>
            </div>
            <div class="col-md-6 col-sm-6 col-xs-6">
                <div class="account">
                    <ul>
                        <li id="your-account">
                        </li>
                        <li id="cart-status">
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- end:logo -->

        <!-- begin:nav-menus -->
        <div class="row">
            <div class="col-md-12">
                <div class="nav-menus">
                </div>
            </div>
        </div>
        <!-- end:nav-menus -->

        <!-- begin:article -->
        <div class="row">
            <!-- begin:sidebar -->
            <div class="col-md-3 col-sm-4 sidebar">
                <div class="row">
                    <div class="col-md-12">
                        <div class="widget" id="shoppingCartWidget">
                        </div>
                        <!-- break -->
                        <div class="widget" id="shoppingCartCheckout">
                        </div>

                    </div>
                </div>
            </div>
            <!-- end:sidebar -->

            <!-- begin:content -->
            <div class="col-md-9 col-sm-8 content vertical-line">
                <div class="row">
                    <div class="col-md-12">
                        <h3>Payment Confirmation</h3>
                        <hr />
                        <div id="details"></div>
                    </div>
                </div>
            </div>
            <!-- end:content -->
        </div>
        <!-- end:article -->

        <!-- begin:footer -->
        <div class="row footer">
            <div class="col-md-12 copyright">
                <div class="row">
                    <div class="col-md-6 col-sm-6 copyright-left">
                        <p>Copyright &copy; Proud Of My Colors 2016. All right reserved.</p>
                    </div>
                    <div class="col-md-6 col-sm-6 copyright-right">
                        <ul class="list-unstyled list-social">
                            <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                            <li><a href="https://www.facebook.com/proudofmycolors"><i class="fa fa-facebook-square"></i></a></li>

                            <li><a href="#"><i class="fa fa-instagram"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>


    </div>
    <!-- end:content -->
    <div class="loadingModal">
        <!-- Place at bottom of page -->
    </div>
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/masonry.pkgd.min.js"></script>
    <script src="js/imagesloaded.pkgd.min.js"></script>
    <script src="js/script.js"></script>
    <script src="/js/accounting.js"></script>
    <script src="/js/bootbox.js"></script>
    <!--aws-->
    <script src="/js/aws/jsbn.js"></script>
    <script src="/js/aws/jsbn2.js"></script>
    <script src="/js/aws/sjcl.js"></script>
    <script src="/js/aws/moment.min.js"></script>
    <script src="/js/aws/aws-cognito-sdk.min.js"></script>
    <script src="/js/aws/amazon-cognito-identity.min.js"></script>
    <script src="/js/aws/aws-sdk-2.3.19.min.js"></script>
    <!--Iron Rock Custom Library-->
    <script src="/js/proudofmycolorsservice.js"></script>
    <script src="/js/index.js"></script>

    <script type="text/javascript">
        $(document).ready(function() {
            var _customerDetails;
            initPage(function(err, obj) {
                //?token=EC-1CB61872B5335341B&PayerID=PKETGAYSH5TCS
                var token = getQueryStringParams('token');
                var customerId = getQueryStringParams('PKETGAYSH5TCS');
                setPayPalDetails(token, customerId, obj);
            });

            //set checkout---get secure token
            function setPayPalDetails(token, customerId, obj) {
                obj = obj || g_proudOfMyColorsService;
                setLoadingState(true);
                var data = {};
                data.token = token;
                data.customerId = customerId;
                obj.paypalCheckout("GetExpressCheckoutDetails", data, function(err, resp) {
                    setLoadingState(false);
                    var orderDetails = JSON.parse(resp.Payload);
                    console.log(orderDetails);
                    if (orderDetails.ACK == "Success") {
                        _customerDetails = orderDetails;
                        displayDetails();
                    }
                });
            }

            function displayDetails() {
                var details = $('#details');
                //var comments = $('<p/>').html('The order details are shown below. An email will be sent with details on how to track the goods.');
                //comments.appendTo(details);
                details.append('<div id="confirmedInstructions"></div><button class="btn btn-primary" id="confirmOrder">Kindly Press to confirm the Payment. Note the details below;</button><hr/>');
                var dl = $('<dl/>').addClass('dl-horizontal');
                dl.append('<dt></dt><dd><b>Personal Info</b></dd>');
                dl.append('<dt>First Name</dt><dd>' + _customerDetails.FIRSTNAME + '</dd>');
                dl.append('<dt>Last Name</dt><dd>' + _customerDetails.LASTNAME + '</dd>');
                dl.append('<dt>EMAIL</dt><dd>' + _customerDetails.EMAIL + '</dd>');
                dl.append('<dt></dt><dd><b>Shipping Details</b></dd>');
                dl.append('<dt>Insurance</dt><dd>' + _customerDetails.INSURANCEOPTIONOFFERED + '</dd>');

                dl.append('<dt>Address Status</dt><dd>' + _customerDetails.ADDRESSSTATUS + '</dd>');

                dl.append('<dt>Ship To City</dt><dd>' + _customerDetails.SHIPTOCITY + '</dd>');
                dl.append('<dt>Country</dt><dd>' + _customerDetails.SHIPTOCOUNTRYNAME + '</dd>');
                dl.append('<dt>Ship To</dt><dd>' + _customerDetails.SHIPTONAME + '</dd>');
                dl.append('<dt>State</dt><dd>' + _customerDetails.SHIPTOSTATE + '</dd>');
                dl.append('<dt>Street</dt><dd>' + _customerDetails.SHIPTOSTREET + '</dd>');
                dl.append('<dt>ZIP Code</dt><dd>' + _customerDetails.SHIPTOZIP + '</dd>');
                dl.append('<dt></dt><dd><b>Cost</b></dd>');
                dl.append('<dt>Currency</dt><dd>' + _customerDetails.CURRENCYCODE + '</dd>');
                dl.append('<dt>Items Cost</dt><dd>' + accounting.formatMoney(_customerDetails.ITEMAMT) + '</dd>');
                dl.append('<dt>Shipping Amt</dt><dd>' + accounting.formatMoney(_customerDetails.SHIPPINGAMT) + '</dd>');
                dl.append('<dt>Shipping Discount</dt><dd>' + accounting.formatMoney(_customerDetails.SHIPDISCAMT) + '</dd>');
                dl.append('<dt>Handling Amt</dt><dd>' + accounting.formatMoney(_customerDetails.HANDLINGAMT) + '</dd>');
                dl.append('<dt>Insurance Amt</dt><dd>' + accounting.formatMoney(_customerDetails.INSURANCEAMT) + '</dd>');
                dl.append('<dt>Tax Amt</dt><dd>' + accounting.formatMoney(_customerDetails.TAXAMT) + '</dd>');
                dl.append('<dt>Total Cost</dt><dd>' + accounting.formatMoney(_customerDetails.AMT) + '</dd>');

                dl.appendTo(details);
                var items = $('<table/>').addClass('table').append("<thead><tr><th>Description</th><th>Price</th><th>Quantity</th><th>Tax</th></tr></thread>");
                var $tbody = $('<tbody/>').appendTo(items);
                for (var i = 0; i < _customerDetails.objects.length; i++) {
                    $tbody.append('<tr><td>' + _customerDetails.objects[i].NAME + '</td><td>' + accounting.formatMoney(_customerDetails.objects[i].AMT) + '</td><td>' + _customerDetails.objects[i].QTY + '</td><td>' + _customerDetails.objects[
                            i].TAXAMT +
                        '</td></tr>');
                }
                items.appendTo(details);
            }

            $('#details').on('click', '#confirmOrder', function() {
                setLoadingState(true);
                g_proudOfMyColorsService.paypalCheckout("DoExpressCheckoutPayment", _customerDetails, function(err, resp) {
                    setLoadingState(false);
                    var confirmInfo = JSON.parse(resp.Payload);
                    console.log(confirmInfo);
                    if (confirmInfo.ACK == "Success") {
                        emptyShoppingCart();
                        $('#details').find('#confirmOrder').hide();
                        $('#details').find('#confirmedInstructions').html('<p>Thank your for your Business. Shipping details will be emailed to you shortly. A confirmation email is also emailed to you so that you can officially become one of our distinquished members.  A member has many priviledegs including the ability to easily track your goods.</p>')
                    }
                });
            });



        });
    </script>


</body>

</html>
